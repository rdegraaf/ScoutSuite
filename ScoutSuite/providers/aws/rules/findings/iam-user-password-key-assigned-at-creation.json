{
    "description": "IAM Access Keys Provisioned At Creation For Users With Passwords",
    "rationale": "IAM Users with Console passwords should not automatically be provisioned with access keys.",
    "remediation": "IAM Users with Console access should be required to create their own API credentials or to submit support requests to account admins to obtain API credentials.",
    "compliance": [
        {
            "name": "CIS Amazon Web Services Foundations",
            "version": "2.0.0",
            "reference": "1.11"
        },
        {
            "name": "ADA Cloud Profile",
            "version": "1.0",
            "reference": "2.7.2"
        }
    ],
    "references": [
        "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html"
    ],
    "dashboard_name": "Users",
    "path": "iam.credential_reports.id",
    "conditions": [
        "and",
        [
            "iam.credential_reports.id.password_enabled",
            "true",
            ""
        ],
        [
        "or",
            [
                "and",
                [
                    "iam.credential_reports.id.access_key_1_last_rotated",
                    "notNull",
                    ""
                ],
                [
                    "iam.credential_reports.id.user_creation_time",
                    "equalDate",
                    "_GET_VALUE_AT_(iam.credential_reports.id.access_key_1_last_rotated)"
                ]
            ],
            [
                "and",
                [
                    "iam.credential_reports.id.access_key_2_last_rotated",
                    "notNull",
                    ""
                ],
                [
                    "iam.credential_reports.id.user_creation_time",
                    "equalDate",
                    "_GET_VALUE_AT_(iam.credential_reports.id.access_key_2_last_rotated)"
                ]
            ]
        ]
    ],
    "id_suffix": "access_key_assigned_at_creation"
}
